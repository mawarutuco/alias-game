<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>類估估畫畫</title>
    <!-- React -->
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>

    <!-- JSX -->
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <!-- 連結Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj"
      crossorigin="anonymous"
    ></script>

    <!-- sweatalert2 -->
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
      .timer {
        font-size: 150%;
      }

      .word {
        font-size: 200%;
        line-height: 8;
      }

      .start,
      .give-up,
      .next {
        font-size: 200%;
        line-height: 6;
      }

      .click_btn:active {
        animation: btn_move 0.3s;
      }

      @keyframes btn_move {
        0% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(10px);
        }
        100% {
          transform: translateY(0px);
        }
      }
      .show_move_up {
        animation: move_up 0.8s;
      }

      @keyframes move_up {
        from {
          transform: translateY(50px);
          opacity: 0;
        }

        to {
          transform: translateY(0px);
          opacity: 1;
        }
      }

      .container {
        height: 98vh;
      }
    </style>
  </head>
  <body>
    <div id="app"></div>
    <script type="text/babel">
      const { useState, useEffect, useRef } = React;
      let words = [
        "冰箱",
        "狗",
        "牛奶",
        "酪梨",
        "歐洲",
        "分配",
        "突然",
        "積累",
        "證實",
        "短暫",
        "能力",
        "條理",
        "強制",
        "奉獻",
        "證明",
        "歧視",
        "懷疑",
        "誇大",
        "異常",
        "害怕",
        "產生",
        "全球",
        "引導",
        "有害",
        "屈辱",
        "憎恨",
        "偽造",
        "立即",
        "阻礙",
        "合理",
        "保存",
        "智力",
        "短暫",
        "相互",
        "善於觀察",
        "正常",
        "長久",
        "肺炎",
        "措施",
        "完全",
        "調解",
        "排練",
        "不滿",
        "正直",
        "次要",
        "明智",
        "短缺",
        "堅固",
        "門檻",
        "想像",
        "筋疲力竭",
        "熱忱",
        "八月",
        "黑色",
        "露營",
        "黑板",
        "秋天",
        "毯子",
        "蠟燭",
        "遠離",
        "糖果",
        "嬰兒",
        "街區",
        "背後",
        "車子",
        "卡片",
        "羽毛球",
        "關心",
        "袋子",
        "仔細",
        "女演",
        "烘烤",
        "攜帶",
        "害怕",
        "麵包店",
        "情形",
        "陽台",
        "城堡",
        "貓",
        "香蕉",
        "無聊",
        "趕上",
        "樂團",
        "慶祝",
        "銀行",
        "手機",
        "烤肉",
        "棒球",
        "兩者",
        "中心",
        "籃子",
        "公分",
        "籃球",
        "椅子",
        "蝙蝠",
        "粉筆",
        "洗澡",
        "機會",
        "浴室",
        "零錢",
        "便宜",
        "海灘",
        "欺騙",
        "檢查",
        "歡呼",
        "美麗",
        "橋",
        "乳酪",
        "接受",
        "橫過",
        "行動",
        "活躍",
        "地址",
        "勸告",
        "事情",
        "違反",
        "航線",
        "允許",
        "單獨",
        "合計",
        "憤怒",
        "任何",
        "地區",
        "爭論",
        "藝術",
        "睡覺",
        "助手",
        "攻擊",
        "聽眾",
        "喚醒",
        "意識",
        "銀行",
        "吃烤",
        "啤酒",
        "初學者",
        "信任",
        "長凳",
        "較好",
        "帳單",
        "沸騰",
        "樹枝",
        "勇敢",
        "摘要",
        "寬",
        "廣播",
        "水桶",
        "平靜",
        "蠟燭",
        "上尉",
        "地毯",
        "胡蘿",
        "城堡",
        "天花",
        "中央",
        "首領",
        "選擇",
        "傑作",
        "店員",
        "聰明",
        "硬幣",
        "大學",
        "梳子",
        "公司",
        "比較",
        "完全",
        "關心",
        "證實",
        "衝突",
        "慶祝",
        "認為",
        "包含",
        "繼續",
        "控制",
        "談論",
        "穀物",
        "棉花",
        "咳嗽",
        "農民",
        "縣市",
        "夫妻",
        "勇氣",
        "課程",
        "有色",
        "奶油",
        "危機",
        "群眾",
        "殘酷",
        "治癒",
        "好奇",
        "水流",
        "窗簾",
        "顧客",
        "聾的",
        "債務",
        "決定",
        "深淺",
        "鹿角",
        "程度",
        "民主",
        "否認",
        "依靠",
        "形容",
        "沙漠",
        "設計",
        "願望",
        "發展",
        "鑽石",
        "日記",
        "通常",
        "恐龍",
        "外交官",
        "方向",
        "發現",
        "距離",
        "分開",
        "公文",
        "畫畫",
        "鴨子",
        "賺得",
        "教育",
        "有效",
        "年齡",
        "選舉",
        "要素",
        "敵人",
        "精力",
        "工程師",
        "入口",
        "信封",
        "羡慕",
        "事件",
        "存在",
        "出口",
        "預料",
        "解釋",
        "額外",
        "失敗",
        "公平",
        "奇特",
        "幻想",
        "過失",
        "害怕",
        "羽毛",
        "柵欄",
        "發燒",
        "作戰",
        "電影",
        "最後",
        "蠢人",
        "愚蠢",
        "足球",
        "強迫",
        "森林",
        "向前",
        "狐狸",
        "法國",
        "友情",
        "煎蛋",
        "車庫",
        "大門",
        "聚集",
        "一般",
        "和藹",
        "先生",
        "德國",
        "進入",
        "手套",
        "球門",
        "神明",
        "金條",
        "盛大",
        "葡萄",
        "問候",
        "看守",
        "客人",
        "嚮導",
        "槍",
        "理髮",
        "大廳",
        "簡直",
        "母雞",
        "英雄",
        "遠足",
        "雇傭",
        "家務",
        "人的",
        "饑餓",
        "有病",
        "改善",
        "英寸",
        "包括",
        "工業",
        "墨水",
        "三國演義",
        "介紹",
        "邀請",
        "鐵礦",
        "日本",
        "甕",
        "笑話",
        "小路",
        "燈籠",
        "姓氏",
        "法律",
        "提拉米蘇",
        "場所",
        "許多",
        "可愛",
        "午餐",
        "發病",
        "雜誌",
        "主要",
        "管理",
        "結婚",
        "眾多",
        "意義",
        "成員",
        "記憶",
        "訊息",
        "方法",
        "午夜",
        "模型",
        "拖把",
        "運動",
        "釘子",
        "狹窄",
        "國家",
        "自然",
        "幾乎",
        "必要",
        "領帶",
        "神經",
        "報紙",
        "英俊",
        "喧鬧",
        "沒有",
        "麵條",
        "堅果",
        "順從",
        "職業",
        "自己",
        "運轉",
        "意見",
        "一般",
        "組織",
        "疼痛",
        "蒼白",
        "平底",
        "原諒",
        "乘客",
        "忍耐",
        "和平",
        "梨子",
        "完美",
        "個人",
        "相片",
        "一堆",
        "大頭",
        "乒乓",
        "管子",
        "平原",
        "植物",
        "盤子",
        "高興",
        "詩",
        "水池",
        "港口",
        "位置",
        "罐頭",
        "權力",
        "稱讚",
        "珍貴",
        "總統",
        "印刷",
        "印表",
        "囚犯",
        "大概",
        "生產",
        "產品",
        "前進",
        "允諾",
        "發音",
        "保護",
        "懲罰",
        "目的",
        "雨衣",
        "相當",
        "閱讀",
        "理由",
        "記錄",
        "反身",
        "拒絕",
        "遺憾",
        "提醒",
        "修理",
        "回答",
        "需要",
        "尊敬",
        "評論",
        "羅馬",
        "橡皮",
        "衝浪",
        "俄羅斯",
        "安全",
        "帆船",
        "舊金山",
        "沙漠",
        "滿意",
        "科學",
        "秘密",
        "秘書",
        "好像",
        "服務",
        "岸邊",
        "呼喊",
        "陣雨",
        "關(",
        "寂靜",
        "寂靜",
        "傻子",
        "溜冰",
        "滑雪",
        "技能",
        "靈巧",
        "困乏",
        "肥皂",
        "社會",
        "士兵",
        "說話",
        "精神",
        "肉體",
        "推開",
        "階段",
        "郵票",
        "蒸",
        "暴風",
        "直的",
        "成就",
        "突然",
        "晚餐",
        "支援",
        "海浪",
        "游泳",
        "餐具",
        "尾巴",
        "眼淚",
        "溫馨",
        "帳蓬",
        "學期",
        "可怕",
        "厚",
        "小偷",
        "直到",
        "東京",
        "舌頭",
        "牙痛",
        "蛋塔",
        "貿易",
        "交通",
        "運輸",
        "旅行",
        "信任",
      ];
      let wordsLen = words.length;
      let timer = null;

      const swalWithBootstrapButtons = Swal.mixin({
        customClass: {
          confirmButton: "btn btn-primary",
          cancelButton: "btn btn-secondary",
        },
        buttonsStyling: false,
      });

      const App = () => {
        const settingSec = useRef(10);
        const point = useRef(0);
        const pointWords = useRef([]);
        const [sec, setSec] = useState(settingSec.current);
        const [isPlaying, setPlaying] = useState(false);
        const [isGiveUp, setGiveUp] = useState(false);
        const [word, setWord] = useState("╰(*°▽°*)╯");

        const startTimer = () =>
          (timer = setInterval(function () {
            setSec((pre) => pre - 1);
          }, 1000));

        const reset = () => {
          clearInterval(timer);
          setPlaying(false);
          setGiveUp(false);
          setWord("╰(*°▽°*)╯");
          setSec(settingSec.current);
        };

        const timePercent = ((sec / settingSec.current) * 80).toString();

        useEffect(() => {
          if (!isPlaying) settingSec.current = sec;
          else if (sec <= 0) {
            swalWithBootstrapButtons.fire(
              "時間到啦",
              `共得 ${point.current} 分`,
              "warning"
            );
            reset();
          }
        }, [sec]);

        return (
          <div class="container show_move_up d-flex flex-column justify-content-between">
            <Timer
              startTimer={startTimer}
              reset={reset}
              point={point}
              isPlaying={isPlaying}
              timePercent={timePercent}
              sec={sec}
              setSec={setSec}
            />
            <div className="border shadow word text-center text-wrap">
              {word}
            </div>
            <MyBtn
              text={`分數：${point.current}`}
              btnClass="btn-light btn-lg"
              doClick={() => {
                swalWithBootstrapButtons.fire(
                  "上局已猜過單字：",
                  `${pointWords.current.join("\n")}`
                );
              }}
              isDisabled={isPlaying}
            />

            <Buttons
              word={word}
              words={words}
              setPlaying={setPlaying}
              isPlaying={isPlaying}
              isGiveUp={isGiveUp}
              setGiveUp={setGiveUp}
              setWord={setWord}
              startTimer={startTimer}
              point={point}
              pointWords={pointWords}
            />
          </div>
        );
      };

      const Buttons = ({
        word,
        words,
        setWord,
        startTimer,
        isPlaying,
        setPlaying,
        isGiveUp,
        setGiveUp,
        point,
        pointWords,
      }) => {
        const randomWord = () => {
          const randomNum = Math.floor(wordsLen * Math.random());
          setWord(words[randomNum]);
          wordsLen--;
          words.splice(randomNum, 1);
        };

        const nextCard = () => {
          pointWords.current.push(word);
          randomWord();
          point.current++;
        };

        const giveUpCard = () => {
          randomWord();
          // isGiveUp()
        };

        const startGame = () => {
          randomWord();
          setPlaying(true);
          startTimer();
          point.current = 0;
          pointWords.current = [];
        };

        return (
          <div>
            {isPlaying ? (
              <div className="d-flex justify-content-between show_move_up">
                <MyBtn
                  text="棄牌"
                  btnClass="give-up btn-danger w-100"
                  doClick={giveUpCard}
                  isDisabled={isGiveUp}
                />
                <MyBtn text="下張" btnClass="next w-100" doClick={nextCard} />
              </div>
            ) : (
              <MyBtn text="開始" btnClass="start w-100" doClick={startGame} />
            )}
          </div>
        );
      };

      const Timer = ({
        reset,
        startTimer,
        point,
        isPlaying,
        timePercent,
        sec,
        setSec,
      }) => {
        const stopGame = () => {
          clearInterval(timer);
          swalWithBootstrapButtons
            .fire({
              title: "暫停中",
              text: `目前得 ${point.current} 分`,
              icon: "warning",
              showCancelButton: true,
              confirmButtonText: "繼續遊戲",
              cancelButtonText: "提早結束",
            })
            .then((result) => {
              if (result.isConfirmed) startTimer();
              else reset();
            });
        };

        return (
          <div className="timer mt-3">
            {isPlaying ? (
              <div className="d-flex justify-content-between">
                <div
                  className="bg-primary text-light ps-1"
                  style={{
                    width: timePercent + "%",
                    borderRadius: "10px",
                  }}
                >
                  {sec}
                </div>
                <MyBtn
                  btnClass="btn btn-secondary"
                  text="暫停"
                  doClick={stopGame}
                />
              </div>
            ) : (
              <MyInputGroup
                value={sec}
                doChange={(e) => setSec(e.target.value)}
              />
            )}
          </div>
        );
      };

      const MyInputGroup = ({ value, doChange }) => {
        return (
          <div className="input-group input-group-lg">
            <span className="input-group-text">設定倒數</span>
            <input
              className="form-control text-center text-wrap"
              value={value}
              onChange={doChange}
            />
            <span className="input-group-text">秒鐘</span>
          </div>
        );
      };

      const MyBtn = ({ text, doClick, btnClass = "", isDisabled = false }) => {
        return (
          <button
            disabled={isDisabled}
            className={"btn btn-primary click_btn " + btnClass}
            onClick={doClick}
          >
            {text}
          </button>
        );
      };

      const app = ReactDOM.createRoot(document.getElementById("app"));
      app.render(<App />);
    </script>
  </body>
</html>
